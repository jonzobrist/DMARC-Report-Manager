#!/bin/bash

# DMARC Report Manager - Status Script

PROJECT_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
RUN_DIR="${PROJECT_ROOT}/.run"

# Colors
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

check_status() {
    local SERVICE_NAME=${1}
    local PID_FILE="${RUN_DIR}/${SERVICE_NAME}.pid"

    if [ -f "${PID_FILE}" ]; then
        PID=$(cat "${PID_FILE}")
        if kill -0 "${PID}" 2>/dev/null; then
            echo -e "${SERVICE_NAME}: ${GREEN}Running${NC} (PID: ${PID})"
        else
            echo -e "${SERVICE_NAME}: ${RED}Stopped${NC} (Stale PID file)"
        fi
    else
        echo -e "${SERVICE_NAME}: ${RED}Stopped${NC}"
    fi
}

echo "DMARC Report Manager Status:"
echo "----------------------------"
check_status "backend"
check_status "frontend"
